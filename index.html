<!DOCTYPE html>
<html>
   <head>
      <title>QRedirect</title>
      <script type="text/javascript" src="https://github.com/schmich/instascan/releases/download/1.0.0/instascan.min.js"></script>
      <style>
         body {
         margin: 0;
         padding: 0;
         overflow:hidden;
         }
         #preview {
         background-position: center center;
         background-repeat: no-repeat;
         background-size: contain;
         width: 100%;
         height: 100%;
         }
      </style>
   </head>
   <body>
      <video id="preview"></video>
      <script type="text/javascript">
         function ValidURL(str) {
         var pattern = new RegExp('^(https?:\/\/)?'+ // protocol
         '((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|'+ // domain name
         '((\d{1,3}\.){3}\d{1,3}))'+ // OR ip (v4) address
         '(\:\d+)?(\/[-a-z\d%_.~+]*)*'+ // port and path
         '(\?[;&a-z\d%_.~+=-]*)?'+ // query string
         '(\#[-a-z\d_]*)?$','i'); // fragment locater
         if(!pattern.test(str)) {
         alert("Please enter a valid URL.");
         return false;
         } else {
         return true;
         }
         }
           let scanner = new Instascan.Scanner({ video: document.getElementById('preview') });
           scanner.addListener('scan', function (content) {
               if (ValidURL(content)){
                 window.location.replace(content);
               }
           });
           Instascan.Camera.getCameras().then(function (cameras) {
             if (cameras.length > 0) {
               if(cameras.length == 2){
                scanner.start(cameras[1]);
               } else {
                scanner.start(cameras[0]);
               }
             } else {
               console.error('No cameras found.');
             }
           }).catch(function (e) {
             console.error(e);
           });
      </script>
   </body>
</html>